@font-face {
    font-family: "CyrillicPixel";
    src: url(assets/fonts/CyrillicPixel.ttf);
}
@font-face {
    font-family: "PixelEmulator";
    src: url(assets/fonts/PixelEmulator.ttf);
}
@font-face {
    font-family: "SFPixelate";
    src: url(assets/fonts/SFPixelate.ttf);
}

/* --- Ensure Body and HTML take full space --- */
html, body {
    overflow: hidden; /* Prevent scrollbars */
    width: 100%;
    height: 100%;
    margin: 0;
    padding: 0;
    position: relative; /* Establish positioning context */
    background: #000;
	color: #fff;
    -ms-touch-action: none;
    touch-action: none;
    box-sizing: border-box; /* Apply border-box globally */
}

/* Apply border-box to all elements */
*, *::before, *::after {
    box-sizing: inherit;
}


a{
  text-decoration: inherit;
  color: inherit;
}

/* --- Canvas Container and Canvas --- */
#c2canvasdiv {
    position: absolute;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    z-index: 1; /* Below UI */
}
canvas#c2canvas {
    display: block; /* Remove potential inline spacing */
    position: absolute;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    -ms-touch-action: none;
    touch-action: none;
}

/* --- UI Overlay Layer --- */
#UI {
    position: absolute; /* Position relative to body/html */
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    z-index: 10; /* Above canvas */
    pointer-events: none; /* Ignore clicks on the container itself */
    overflow: hidden;
}

/* --- Game Column (Container for UI elements) --- */
.game-column {
    position: absolute; /* Position absolutely within #UI */
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%); /* Center using transform */
    width: 100%; /* Take full width available within constraints */
    height: 100%; /* Take full height available */
    max-width: 480px; /* Constrain width like canvas (adjust if needed) */
    display: flex; /* Use flex to manage internal layout */
    flex-direction: column; /* Stack elements vertically */
    justify-content: space-between; /* Push dock to bottom, windows towards bottom */
    align-items: center; /* Center children horizontally by default */
}


/* --- Pointer Events Handling --- */
#UI * {
    pointer-events: none;
}
/* Selectively re-enable pointer events ONLY for necessary interactive elements */
#UI button,
#UI a,
#UI input,
#UI label,
#play-menu,
#steps-window,
#chat-window,
#play-menu-toggle,
#steps-window-toggle,
#chat-window-toggle,
#chat-exit {
     pointer-events: auto;
}


/*----- UTILITY AND UNIVERSAL ----*/
.center-vh{
    position: absolute; /* Use absolute relative to .game-column */
    top: 50%;
    left: 50%;
    transform: translateX(-50%) translateY(-50%);
    width: 90%;
    max-width: 300px;
}
.client-area{
    min-height: max-content;
}


/*----- PIXEL UI -----*/
/* ... (Pixel styles remain the same) ... */
.pixel-text-box{ display: inline-block; font-family: "PixelEmulator"; font-size: .9em; width: 50%; text-align: center; border-radius: 0px; border: none; text-decoration: none; margin: .5em; padding: .5em; background-color: var(--button-bg); color: var(--main-font); box-shadow: 4px 4px var(--pixel-shadow-inset) inset, 4px 0px 0px var(--pixel-shadow-bot), 0px 4px 0px var(--pixel-shadow-right), -4px 0px 0px var(--pixel-shadow-left), 0px -4px 0px var(--pixel-shadow-top), 0px 4px 10px var(--blue-shadow), 0px 5px 10px var(--blue-shadow), 0px 0px 15px var(--blue-shadow); }
.pixel-text-box:hover{ -webkit-filter: brightness(110%); filter: brightness(110%); }
.pixel-text-box:focus{ outline: -4px solid #aaaaff; text-decoration: none; filter: brightness(110%); box-shadow: inherit, 0px 0px 20px white, 0px 0px 20px white, 0px 0px 20px white; animation: pulse-focus 1s alternate infinite; }
.pixel-window{ text-align: center; border-radius: 0px; border: solid 8px var(--button-bg); text-decoration: none; margin: .5em; padding: .5em; background-color: var(--window-bg); color: var(--main-font); position: relative; box-shadow: -4px -4px var(--pixel-shadow-inset) inset, 4px 4px #2224 inset, 4px 0px 0px var(--pixel-shadow-bot), 0px 4px 0px var(--pixel-shadow-right), -4px 0px 0px var(--pixel-shadow-left), 0px -4px 0px var(--pixel-shadow-top), 0px 4px 10px var(--blue-shadow), 0px 5px 10px var(--blue-shadow), 0px 0px 15px var(--blue-shadow); }
.pixel-window>.title-bar{ position: relative; display: flex; top: -16px; margin: -20px 0px 20px -16px; width: calc( 100% + 32px ); padding: 0px; height: 3em; box-shadow: -4px 0px var(--pixel-shadow-inset) inset, 4px 0px 0px var(--pixel-shadow-bot), 0px 4px 0px var(--pixel-shadow-right), -4px 0px 0px var(--pixel-shadow-left), 0px -4px 0px var(--pixel-shadow-top), 0px 4px 10px var(--blue-shadow); text-shadow: 0px 2px 4px #0006; }
.pixel-window>.title-bar:hover{ -webkit-filter: none; filter: none; }
.pixel-window>.title-bar>button{ height: 32px; width: 32px; text-align: center; }
.pixel-window>.title-bar>.title{ display: inline-block; position: relative; margin: auto auto; width:100%; font-size: 1.2em; }
.pixel-progress{ float: right; font-family: "PixelEmulator"; font-size: .9em; text-align: center; border-radius: 0px; border: none; text-decoration: none; margin: .5em 2em; padding: .5em; background-color: var(--button-bg); box-shadow: -4px 0px var(--pixel-shadow-inset) inset, 4px 0px 0px var(--pixel-shadow-bot), 0px 4px 0px var(--pixel-shadow-right), -4px 0px 0px var(--pixel-shadow-left), 0px -4px 0px var(--pixel-shadow-top), 0px 4px 10px var(--blue-shadow), 0px 5px 10px var(--blue-shadow), 0px 0px 15px var(--blue-shadow); }
.pixel-progress-bar{ margin: 4px 8px 4px 4px; width: 1em; height: 150px; float: bottom; box-shadow: -4px 0px var(--pixel-shadow-inset) inset, 4px 0px 0px var(--pixel-shadow-bot), 0px 4px 0px var(--pixel-shadow-right), -4px 0px 0px var(--pixel-shadow-left), 0px -4px 0px var(--pixel-shadow-top), 0px 4px 10px var(--blue-shadow), 0px 5px 10px var(--blue-shadow), 0px 0px 15px var(--blue-shadow); }
.chat-font{ font-family: "SFPixelate", sans-serif; line-height: 1.1em; color: var(--message-font); }
.icon-box{ height: 3em; width: 3em; }

/*----- UI COLORING ----*/
.red-bg{ background-color: var(--red-accent); }

/*----- PLAY SCREEN-----*/
#play-menu{ width: 90%; max-width: 300px; animation: menu-fade-in 0.2s; z-index: 12; background-color: #666e; }
#game-progress-bar{ background: linear-gradient(0deg, rgb(10,10,10) 25%, var(--button-bg) 25%); transition: background 2s ease-in-out; margin: 10px auto; }
#play-menu-toggle{ position: absolute; top: 0.5em; right: 0.5em; z-index: 11; } /* Position relative to .game-column */
#play-menu-toggle>svg{ height: 100%; width: 100%; }

/*----- UI DOCK & CONTAINER ----*/
#ui-dock{
    /* position: absolute; */ /* No longer needed if using flexbox on parent */
    /* bottom: 0; */
    /* left: 0; */
    width: 100%; /* Take full width of .game-column */
    display: flex;
    flex-direction: row; /* Changed from row-reverse */
    justify-content: center; /* Center items horizontally */
    z-index: 11;
    padding: 0 0.5em;
    margin-top: auto; /* Push to bottom in flex column */
}
#ui-window-container{
    /* position: absolute; */ /* No longer needed */
    /* bottom: 3.5em; */
    /* left: 0; */
    width: 100%; /* Take full width of .game-column */
    display: flex;
    flex-direction: column; /* Stack windows vertically */
    align-items: center; /* Center windows horizontally */
    padding: 0 0.5em;
    margin-bottom: 0.5em; /* Space above dock */
}

/*----- CHAT -----*/
.message{ font-family: "SFPixelate", sans-serif; text-align: left; color: #0006; }
.message.player-chat{ color: var(--message-font); }
.message.system-err{ color: #8008 }
#chat-window-toggle>svg{ height: 100%; width: 100%; }
#chat-window{ height: 29vh; width: 95%; max-width: 400px; margin-bottom: 0.5em; position: relative; }
#chat{ height: calc(100% - 1.5em); width: 100%; overflow-y: scroll; overscroll-behavior: contain; scrollbar-width: none; -ms-overflow-style: none; }
#chat::-webkit-scrollbar { display: none; }
#chat-client-area{ position: relative; height: 100%; }
#chat-exit{ font-size: .9em; height: fit-content; width: auto; padding: 2px 4px; position: absolute; top: -10px; right: -10px; z-index: 13; }

/*---- STEPS (LADDER QUOTES) ----*/
#steps-window{ max-height: 33vh; width: 95%; max-width: 400px; margin-bottom: 0.5em; position: relative; }
#steps{ overflow-y: scroll; overscroll-behavior: contain; scrollbar-width: none; -ms-overflow-style: none; height: 100%; }
#steps::-webkit-scrollbar { display: none; }

/* -----ANIMATION------*/
@keyframes invalid-input{ 0% {transform: translateX(-4px);} 100% {transform: translateX(4px);} }
@keyframes pulse-focus{ 0% {background-color: #222;} 100% {background-color: #444;} }
@keyframes menu-fade-in { 0% { opacity: 0%; transform: translate(-50%, -55%);} 100% { opacity: 100%; transform: translate(-50%, -50%);} }

/*----- MEDIA ADJUSTMENTS -----*/
/* Media query might not be needed now if default is centered */
/* @media (width < 600px){ ... } */

/*----- COLOR VARIABLES ------*/
svg{ fill:var(--main-font); }
:root{ --gold-text: rgb(241, 220, 151); --dark-blue: #224; --red-accent: #934; --main-font: #ccc; --message-font: #000; --blue-shadow: #13292a8f; --button-bg: #333; --pixel-shadow-inset: #fff1; --pixel-shadow-left: #222; --pixel-shadow-right: #222; --pixel-shadow-bot: #111; --pixel-shadow-top: #222; --window-bg: #aaac; --menu-dark-col333dor: #225; }

